---
- name: Restic install packages
  apt:
    name: "{{ backup__restic_default_packages }}"
    update_cache: yes
    state: present
  when:
    - backup__install

- name: Create ssh_config file
  template:
    src: ssh_config
    dest: "/root/.ssh/config"
    mode: 0644
    owner: root
    group: root
  when:
    - backup__install
    - backup__configure

- name: Create restic password file
  template:
    src: restic_repo_password
    dest: "/root/.restic_repo_password"
    mode: 0600
    owner: root
    group: root
  when:
    - backup__install
    - backup__configure

# - name: Create restic ssh identity file
#   when:
#     - backup__install
#     - backup__configure
#     - backup__ssh_id

# -name: Copy ssh id file(s) into local file

# -name: Install ssh id  into storage box
#    Currently done manually with : cat ~/.ssh/{{ backup__ssh_id }}.pub | ssh -p23 u474134@u474134.your-storagebox.de install-ssh-key
